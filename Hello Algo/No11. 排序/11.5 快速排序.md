   å¿«é€Ÿæ’åºï¼ˆquick sortï¼‰æ˜¯ä¸€ç§åŸºäºåˆ†æ²»ç­–ç•¥çš„æ’åºç®—æ³•ï¼Œè¿è¡Œé«˜æ•ˆï¼Œåº”ç”¨å¹¿æ³›ã€‚

å¿«é€Ÿæ’åºçš„æ ¸å¿ƒæ“ä½œæ˜¯â€œå“¨å…µåˆ’åˆ†â€ï¼Œå…¶ç›®æ ‡æ˜¯ï¼šé€‰æ‹©æ•°ç»„ä¸­çš„æŸä¸ªå…ƒç´ ä½œä¸ºâ€œåŸºå‡†æ•°â€ï¼Œå°†æ‰€æœ‰å°äºåŸºå‡†æ•°çš„å…ƒç´ ç§»åˆ°å…¶å·¦ä¾§ï¼Œè€Œå¤§äºåŸºå‡†æ•°çš„å…ƒç´ ç§»åˆ°å…¶å³ä¾§ã€‚å…·ä½“æ¥è¯´ï¼Œå“¨å…µåˆ’åˆ†çš„æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚
1. é€‰å–æ•°ç»„æœ€å·¦ç«¯å…ƒç´ ä½œä¸ºåŸºå‡†æ•°ï¼Œåˆå§‹åŒ–ä¸¤ä¸ªæŒ‡é’ˆÂ `i`Â å’ŒÂ `j`Â åˆ†åˆ«æŒ‡å‘æ•°ç»„çš„ä¸¤ç«¯ã€‚
2. è®¾ç½®ä¸€ä¸ªå¾ªç¯ï¼Œåœ¨æ¯è½®ä¸­ä½¿ç”¨Â `i`ï¼ˆ`j`ï¼‰åˆ†åˆ«å¯»æ‰¾ç¬¬ä¸€ä¸ªæ¯”åŸºå‡†æ•°å¤§ï¼ˆå°ï¼‰çš„å…ƒç´ ï¼Œç„¶åäº¤æ¢è¿™ä¸¤ä¸ªå…ƒç´ ã€‚
3. å¾ªç¯æ‰§è¡Œæ­¥éª¤Â `2.`Â ï¼Œç›´åˆ°Â `i`Â å’ŒÂ `j`Â ç›¸é‡æ—¶åœæ­¢ï¼Œæœ€åå°†åŸºå‡†æ•°äº¤æ¢è‡³ä¸¤ä¸ªå­æ•°ç»„çš„åˆ†ç•Œçº¿ã€‚
![[Pasted image 20240604173314.png]]
![[Pasted image 20240604173324.png]]
![[Pasted image 20240604173330.png]]
![[Pasted image 20240604173335.png]]
![[Pasted image 20240604173341.png]]
![[Pasted image 20240604173348.png]]
![[Pasted image 20240604173354.png]]
![[Pasted image 20240604173359.png]]
![[Pasted image 20240604173404.png]]

å“¨å…µåˆ’åˆ†å®Œæˆåï¼ŒåŸæ•°ç»„è¢«åˆ’åˆ†æˆä¸‰éƒ¨åˆ†ï¼šå·¦å­æ•°ç»„ã€åŸºå‡†æ•°ã€å³å­æ•°ç»„ï¼Œä¸”æ»¡è¶³â€œå·¦å­æ•°ç»„ä»»æ„å…ƒç´ Â â‰¤Â åŸºå‡†æ•°Â â‰¤Â å³å­æ•°ç»„ä»»æ„å…ƒç´ â€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥åªéœ€å¯¹è¿™ä¸¤ä¸ªå­æ•°ç»„è¿›è¡Œæ’åºã€‚

```ad-tip
title: å¿«é€Ÿæ’åºçš„åˆ†æ²»ç­–ç•¥
å“¨å…µåˆ’åˆ†çš„å®è´¨æ˜¯å°†ä¸€ä¸ªè¾ƒé•¿æ•°ç»„çš„æ’åºé—®é¢˜ç®€åŒ–ä¸ºä¸¤ä¸ªè¾ƒçŸ­æ•°ç»„çš„æ’åºé—®é¢˜ã€‚
```
```python
def partition(self, nums: list[int], left: int, right: int) -> int:
	"""å“¨å…µåˆ’åˆ†"""
	# ä»¥ nums[left] ä¸ºåŸºå‡†æ•°
	i, j = left, right
	while i < j:
	    while i < j and nums[j] >= nums[left]:
	        j -= 1  # ä»å³å‘å·¦æ‰¾é¦–ä¸ªå°äºåŸºå‡†æ•°çš„å…ƒç´ 
	    while i < j and nums[i] <= nums[left]:
	        i += 1  # ä»å·¦å‘å³æ‰¾é¦–ä¸ªå¤§äºåŸºå‡†æ•°çš„å…ƒç´ 
	    # å…ƒç´ äº¤æ¢
	    nums[i], nums[j] = nums[j], nums[i]
	# å°†åŸºå‡†æ•°äº¤æ¢è‡³ä¸¤å­æ•°ç»„çš„åˆ†ç•Œçº¿
	nums[i], nums[left] = nums[left], nums[i]
	return i  # è¿”å›åŸºå‡†æ•°çš„ç´¢å¼•
```

## 11.5.1 ç®—æ³•æµç¨‹
å¿«é€Ÿæ’åºçš„æ•´ä½“æµç¨‹å¦‚å›¾æ‰€ç¤ºã€‚
1. é¦–å…ˆï¼Œå¯¹åŸæ•°ç»„æ‰§è¡Œä¸€æ¬¡â€œå“¨å…µåˆ’åˆ†â€ï¼Œå¾—åˆ°æœªæ’åºçš„å·¦å­æ•°ç»„å’Œå³å­æ•°ç»„ã€‚
2. ç„¶åï¼Œå¯¹å·¦å­æ•°ç»„å’Œå³å­æ•°ç»„åˆ†åˆ«é€’å½’æ‰§è¡Œâ€œå“¨å…µåˆ’åˆ†â€ã€‚
3. æŒç»­é€’å½’ï¼Œç›´è‡³å­æ•°ç»„é•¿åº¦ä¸º 1 æ—¶ç»ˆæ­¢ï¼Œä»è€Œå®Œæˆæ•´ä¸ªæ•°ç»„çš„æ’åºã€‚
![[Pasted image 20240604173624.png]]
```python
def quick_sort(self, nums: list[int], left: int, right: int):
	"""å¿«é€Ÿæ’åº"""
	# å­æ•°ç»„é•¿åº¦ä¸º 1 æ—¶ç»ˆæ­¢é€’å½’
	if left >= right:
	    return
	# å“¨å…µåˆ’åˆ†
	pivot = self.partition(nums, left, right)
	# é€’å½’å·¦å­æ•°ç»„ã€å³å­æ•°ç»„
	self.quick_sort(nums, left, pivot - 1)
	self.quick_sort(nums, pivot + 1, right)
```

## 11.5.2 ç®—æ³•ç‰¹æ€§
- **æ—¶é—´å¤æ‚åº¦ä¸ºÂ ğ‘‚(ğ‘›logâ¡ğ‘›)ã€è‡ªé€‚åº”æ’åº**ï¼šåœ¨å¹³å‡æƒ…å†µä¸‹ï¼Œå“¨å…µåˆ’åˆ†çš„é€’å½’å±‚æ•°ä¸ºÂ logâ¡ğ‘›Â ï¼Œæ¯å±‚ä¸­çš„æ€»å¾ªç¯æ•°ä¸ºÂ ğ‘›Â ï¼Œæ€»ä½“ä½¿ç”¨Â ğ‘‚(ğ‘›logâ¡ğ‘›)Â æ—¶é—´ã€‚åœ¨æœ€å·®æƒ…å†µä¸‹ï¼Œæ¯è½®å“¨å…µåˆ’åˆ†æ“ä½œéƒ½å°†é•¿åº¦ä¸ºÂ ğ‘›Â çš„æ•°ç»„åˆ’åˆ†ä¸ºé•¿åº¦ä¸ºÂ 0Â å’ŒÂ ğ‘›âˆ’1Â çš„ä¸¤ä¸ªå­æ•°ç»„ï¼Œæ­¤æ—¶é€’å½’å±‚æ•°è¾¾åˆ°Â ğ‘›Â ï¼Œæ¯å±‚ä¸­çš„å¾ªç¯æ•°ä¸ºÂ ğ‘›Â ï¼Œæ€»ä½“ä½¿ç”¨Â ğ‘‚(ğ‘›2)Â æ—¶é—´ã€‚
- **ç©ºé—´å¤æ‚åº¦ä¸ºÂ ğ‘‚(ğ‘›)ã€åŸåœ°æ’åº**ï¼šåœ¨è¾“å…¥æ•°ç»„å®Œå…¨å€’åºçš„æƒ…å†µä¸‹ï¼Œè¾¾åˆ°æœ€å·®é€’å½’æ·±åº¦Â ğ‘›Â ï¼Œä½¿ç”¨Â ğ‘‚(ğ‘›)Â æ ˆå¸§ç©ºé—´ã€‚æ’åºæ“ä½œæ˜¯åœ¨åŸæ•°ç»„ä¸Šè¿›è¡Œçš„ï¼Œæœªå€ŸåŠ©é¢å¤–æ•°ç»„ã€‚
- **éç¨³å®šæ’åº**ï¼šåœ¨å“¨å…µåˆ’åˆ†çš„æœ€åä¸€æ­¥ï¼ŒåŸºå‡†æ•°å¯èƒ½ä¼šè¢«äº¤æ¢è‡³ç›¸ç­‰å…ƒç´ çš„å³ä¾§ã€‚

## 11.5.3 å¿«é€Ÿæ’åºä¸ºä»€ä¹ˆå¿«
ä»åç§°ä¸Šå°±èƒ½çœ‹å‡ºï¼Œå¿«é€Ÿæ’åºåœ¨æ•ˆç‡æ–¹é¢åº”è¯¥å…·æœ‰ä¸€å®šçš„ä¼˜åŠ¿ã€‚å°½ç®¡å¿«é€Ÿæ’åºçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸â€œå½’å¹¶æ’åºâ€å’Œâ€œå †æ’åºâ€ç›¸åŒï¼Œä½†é€šå¸¸å¿«é€Ÿæ’åºçš„æ•ˆç‡æ›´é«˜ï¼Œä¸»è¦æœ‰ä»¥ä¸‹åŸå› ã€‚
- **å‡ºç°æœ€å·®æƒ…å†µçš„æ¦‚ç‡å¾ˆä½**ï¼šè™½ç„¶å¿«é€Ÿæ’åºçš„æœ€å·®æ—¶é—´å¤æ‚åº¦ä¸ºÂ ğ‘‚(ğ‘›2)Â ï¼Œæ²¡æœ‰å½’å¹¶æ’åºç¨³å®šï¼Œä½†åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¿«é€Ÿæ’åºèƒ½åœ¨Â ğ‘‚(ğ‘›logâ¡ğ‘›)Â çš„æ—¶é—´å¤æ‚åº¦ä¸‹è¿è¡Œã€‚
- **ç¼“å­˜ä½¿ç”¨æ•ˆç‡é«˜**ï¼šåœ¨æ‰§è¡Œå“¨å…µåˆ’åˆ†æ“ä½œæ—¶ï¼Œç³»ç»Ÿå¯å°†æ•´ä¸ªå­æ•°ç»„åŠ è½½åˆ°ç¼“å­˜ï¼Œå› æ­¤è®¿é—®å…ƒç´ çš„æ•ˆç‡è¾ƒé«˜ã€‚è€Œåƒâ€œå †æ’åºâ€è¿™ç±»ç®—æ³•éœ€è¦è·³è·ƒå¼è®¿é—®å…ƒç´ ï¼Œä»è€Œç¼ºä¹è¿™ä¸€ç‰¹æ€§ã€‚
- **å¤æ‚åº¦çš„å¸¸æ•°ç³»æ•°å°**ï¼šåœ¨ä¸Šè¿°ä¸‰ç§ç®—æ³•ä¸­ï¼Œå¿«é€Ÿæ’åºçš„æ¯”è¾ƒã€èµ‹å€¼ã€äº¤æ¢ç­‰æ“ä½œçš„æ€»æ•°é‡æœ€å°‘ã€‚è¿™ä¸â€œæ’å…¥æ’åºâ€æ¯”â€œå†’æ³¡æ’åºâ€æ›´å¿«çš„åŸå› ç±»ä¼¼ã€‚

## 11.5.4 åŸºå‡†æ•°ä¼˜åŒ–
**å¿«é€Ÿæ’åºåœ¨æŸäº›è¾“å…¥ä¸‹çš„æ—¶é—´æ•ˆç‡å¯èƒ½é™ä½**ã€‚ä¸¾ä¸€ä¸ªæç«¯ä¾‹å­ï¼Œå‡è®¾è¾“å…¥æ•°ç»„æ˜¯å®Œå…¨å€’åºçš„ï¼Œç”±äºæˆ‘ä»¬é€‰æ‹©æœ€å·¦ç«¯å…ƒç´ ä½œä¸ºåŸºå‡†æ•°ï¼Œé‚£ä¹ˆåœ¨å“¨å…µåˆ’åˆ†å®Œæˆåï¼ŒåŸºå‡†æ•°è¢«äº¤æ¢è‡³æ•°ç»„æœ€å³ç«¯ï¼Œå¯¼è‡´å·¦å­æ•°ç»„é•¿åº¦ä¸ºÂ ğ‘›âˆ’1ã€å³å­æ•°ç»„é•¿åº¦ä¸ºÂ 0Â ã€‚å¦‚æ­¤é€’å½’ä¸‹å»ï¼Œæ¯è½®å“¨å…µåˆ’åˆ†åéƒ½æœ‰ä¸€ä¸ªå­æ•°ç»„çš„é•¿åº¦ä¸ºÂ 0Â ï¼Œåˆ†æ²»ç­–ç•¥å¤±æ•ˆï¼Œå¿«é€Ÿæ’åºé€€åŒ–ä¸ºâ€œå†’æ³¡æ’åºâ€çš„è¿‘ä¼¼å½¢å¼ã€‚

ä¸ºäº†å°½é‡é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œ**æˆ‘ä»¬å¯ä»¥ä¼˜åŒ–å“¨å…µåˆ’åˆ†ä¸­çš„åŸºå‡†æ•°çš„é€‰å–ç­–ç•¥**ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥éšæœºé€‰å–ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†æ•°ã€‚ç„¶è€Œï¼Œå¦‚æœè¿æ°”ä¸ä½³ï¼Œæ¯æ¬¡éƒ½é€‰åˆ°ä¸ç†æƒ³çš„åŸºå‡†æ•°ï¼Œæ•ˆç‡ä»ç„¶ä¸å°½å¦‚äººæ„ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¼–ç¨‹è¯­è¨€é€šå¸¸ç”Ÿæˆçš„æ˜¯â€œä¼ªéšæœºæ•°â€ã€‚å¦‚æœæˆ‘ä»¬é’ˆå¯¹ä¼ªéšæœºæ•°åºåˆ—æ„å»ºä¸€ä¸ªç‰¹å®šçš„æµ‹è¯•æ ·ä¾‹ï¼Œé‚£ä¹ˆå¿«é€Ÿæ’åºçš„æ•ˆç‡ä»ç„¶å¯èƒ½åŠ£åŒ–ã€‚

ä¸ºäº†è¿›ä¸€æ­¥æ”¹è¿›ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•°ç»„ä¸­é€‰å–ä¸‰ä¸ªå€™é€‰å…ƒç´ ï¼ˆé€šå¸¸ä¸ºæ•°ç»„çš„é¦–ã€å°¾ã€ä¸­ç‚¹å…ƒç´ ï¼‰ï¼Œ**å¹¶å°†è¿™ä¸‰ä¸ªå€™é€‰å…ƒç´ çš„ä¸­ä½æ•°ä½œä¸ºåŸºå‡†æ•°**ã€‚è¿™æ ·ä¸€æ¥ï¼ŒåŸºå‡†æ•°â€œæ—¢ä¸å¤ªå°ä¹Ÿä¸å¤ªå¤§â€çš„æ¦‚ç‡å°†å¤§å¹…æå‡ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€‰å–æ›´å¤šå€™é€‰å…ƒç´ ï¼Œä»¥è¿›ä¸€æ­¥æé«˜ç®—æ³•çš„ç¨³å¥æ€§ã€‚é‡‡ç”¨è¿™ç§æ–¹æ³•åï¼Œæ—¶é—´å¤æ‚åº¦åŠ£åŒ–è‡³Â ğ‘‚(ğ‘›2)Â çš„æ¦‚ç‡å¤§å¤§é™ä½ã€‚
```python
def median_three(self, nums: list[int], left: int, mid: int, right: int) -> int:
    """é€‰å–ä¸‰ä¸ªå€™é€‰å…ƒç´ çš„ä¸­ä½æ•°"""
    l, m, r = nums[left], nums[mid], nums[right]
    if (l <= m <= r) or (r <= m <= l):
        return mid  # m åœ¨ l å’Œ r ä¹‹é—´
    if (m <= l <= r) or (r <= l <= m):
        return left  # l åœ¨ m å’Œ r ä¹‹é—´
    return right

def partition(self, nums: list[int], left: int, right: int) -> int:
    """å“¨å…µåˆ’åˆ†ï¼ˆä¸‰æ•°å–ä¸­å€¼ï¼‰"""
    # ä»¥ nums[left] ä¸ºåŸºå‡†æ•°
    med = self.median_three(nums, left, (left + right) // 2, right)
    # å°†ä¸­ä½æ•°äº¤æ¢è‡³æ•°ç»„æœ€å·¦ç«¯
    nums[left], nums[med] = nums[med], nums[left]
    # ä»¥ nums[left] ä¸ºåŸºå‡†æ•°
    i, j = left, right
    while i < j:
        while i < j and nums[j] >= nums[left]:
            j -= 1  # ä»å³å‘å·¦æ‰¾é¦–ä¸ªå°äºåŸºå‡†æ•°çš„å…ƒç´ 
        while i < j and nums[i] <= nums[left]:
            i += 1  # ä»å·¦å‘å³æ‰¾é¦–ä¸ªå¤§äºåŸºå‡†æ•°çš„å…ƒç´ 
        # å…ƒç´ äº¤æ¢
        nums[i], nums[j] = nums[j], nums[i]
    # å°†åŸºå‡†æ•°äº¤æ¢è‡³ä¸¤å­æ•°ç»„çš„åˆ†ç•Œçº¿
    nums[i], nums[left] = nums[left], nums[i]
    return i  # è¿”å›åŸºå‡†æ•°çš„ç´¢å¼•
```

## 11.5.5 å°¾é€’å½’ä¼˜åŒ–
**åœ¨æŸäº›è¾“å…¥ä¸‹ï¼Œå¿«é€Ÿæ’åºå¯èƒ½å ç”¨ç©ºé—´è¾ƒå¤š**ã€‚ä»¥å®Œå…¨æœ‰åºçš„è¾“å…¥æ•°ç»„ä¸ºä¾‹ï¼Œè®¾é€’å½’ä¸­çš„å­æ•°ç»„é•¿åº¦ä¸ºÂ ğ‘šÂ ï¼Œæ¯è½®å“¨å…µåˆ’åˆ†æ“ä½œéƒ½å°†äº§ç”Ÿé•¿åº¦ä¸ºÂ 0Â çš„å·¦å­æ•°ç»„å’Œé•¿åº¦ä¸ºÂ ğ‘šâˆ’1Â çš„å³å­æ•°ç»„ï¼Œè¿™æ„å‘³ç€æ¯ä¸€å±‚é€’å½’è°ƒç”¨å‡å°‘çš„é—®é¢˜è§„æ¨¡éå¸¸å°ï¼ˆåªå‡å°‘ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œé€’å½’æ ‘çš„é«˜åº¦ä¼šè¾¾åˆ°Â ğ‘›âˆ’1Â ï¼Œæ­¤æ—¶éœ€è¦å ç”¨Â ğ‘‚(ğ‘›)Â å¤§å°çš„æ ˆå¸§ç©ºé—´ã€‚

ä¸ºäº†é˜²æ­¢æ ˆå¸§ç©ºé—´çš„ç´¯ç§¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯è½®å“¨å…µæ’åºå®Œæˆåï¼Œæ¯”è¾ƒä¸¤ä¸ªå­æ•°ç»„çš„é•¿åº¦ï¼Œ**ä»…å¯¹è¾ƒçŸ­çš„å­æ•°ç»„è¿›è¡Œé€’å½’**ã€‚ç”±äºè¾ƒçŸ­å­æ•°ç»„çš„é•¿åº¦ä¸ä¼šè¶…è¿‡Â ğ‘›/2Â ï¼Œå› æ­¤è¿™ç§æ–¹æ³•èƒ½ç¡®ä¿é€’å½’æ·±åº¦ä¸è¶…è¿‡Â logâ¡ğ‘›Â ï¼Œä»è€Œå°†æœ€å·®ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–è‡³Â ğ‘‚(logâ¡ğ‘›)Â ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š
```python
def quick_sort(self, nums: list[int], left: int, right: int):
	"""å¿«é€Ÿæ’åºï¼ˆå°¾é€’å½’ä¼˜åŒ–ï¼‰"""
	# å­æ•°ç»„é•¿åº¦ä¸º 1 æ—¶ç»ˆæ­¢
	while left < right:
	    # å“¨å…µåˆ’åˆ†æ“ä½œ
	    pivot = self.partition(nums, left, right)
	    # å¯¹ä¸¤ä¸ªå­æ•°ç»„ä¸­è¾ƒçŸ­çš„é‚£ä¸ªæ‰§è¡Œå¿«é€Ÿæ’åº
	    if pivot - left < right - pivot:
	        self.quick_sort(nums, left, pivot - 1)  # é€’å½’æ’åºå·¦å­æ•°ç»„
	        left = pivot + 1  # å‰©ä½™æœªæ’åºåŒºé—´ä¸º [pivot + 1, right]
	    else:
	        self.quick_sort(nums, pivot + 1, right)  # é€’å½’æ’åºå³å­æ•°ç»„
	        right = pivot - 1  # å‰©ä½™æœªæ’åºåŒºé—´ä¸º [left, pivot - 1]
```