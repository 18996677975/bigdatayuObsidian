| LeetCode                                                                                                              | åŠ›æ‰£                                                                                        | éš¾åº¦  |
| --------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- | --- |
| [1038. Binary Search Tree to Greater Sum Tree](https://leetcode.com/problems/binary-search-tree-to-greater-sum-tree/) | [1038. ä»äºŒå‰æœç´¢æ ‘åˆ°æ›´å¤§å’Œæ ‘](https://leetcode.cn/problems/binary-search-tree-to-greater-sum-tree/) | ğŸŸ   |
| [230. Kth Smallest Element in a BST](https://leetcode.com/problems/kth-smallest-element-in-a-bst/)                    | [230. äºŒå‰æœç´¢æ ‘ä¸­ç¬¬Kå°çš„å…ƒç´ ](https://leetcode.cn/problems/kth-smallest-element-in-a-bst/)          | ğŸŸ   |
| [538. Convert BST to Greater Tree](https://leetcode.com/problems/convert-bst-to-greater-tree/)                        | [538. æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘](https://leetcode.cn/problems/convert-bst-to-greater-tree/)            | ğŸŸ   |
| -                                                                                                                     | [å‰‘æŒ‡ Offer II 054. æ‰€æœ‰å¤§äºç­‰äºèŠ‚ç‚¹çš„å€¼ä¹‹å’Œ](https://leetcode.cn/problems/w6cpku/)                     | ğŸŸ   |

å‰æ–‡æ‰‹æŠŠæ‰‹å¸¦ä½ åˆ·äºŒå‰æ ‘å·²ç»å†™äº†Â [ç¬¬ä¸€æœŸ](https://labuladong.online/algo/data-structure/binary-tree-part1/)ï¼Œ[ç¬¬äºŒæœŸ](https://labuladong.online/algo/data-structure/binary-tree-part2/)Â å’ŒÂ [ç¬¬ä¸‰æœŸ](https://labuladong.online/algo/data-structure/binary-tree-part3/)ï¼Œä»Šå¤©å†™ä¸€ç¯‡äºŒå‰æœç´¢æ ‘ï¼ˆBinary Search Treeï¼Œåæ–‡ç®€å†™ BSTï¼‰ç›¸å…³çš„æ–‡ç« ï¼Œæ‰‹æŠŠæ‰‹å¸¦ä½ åˆ· BSTã€‚

é¦–å…ˆï¼ŒBST çš„ç‰¹æ€§å¤§å®¶åº”è¯¥éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼š
1ã€å¯¹äº BST çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹Â `node`ï¼Œå·¦å­æ ‘èŠ‚ç‚¹çš„å€¼éƒ½æ¯”Â `node`Â çš„å€¼è¦å°ï¼Œå³å­æ ‘èŠ‚ç‚¹çš„å€¼éƒ½æ¯”Â `node`Â çš„å€¼å¤§ã€‚
2ã€å¯¹äº BST çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹Â `node`ï¼Œå®ƒçš„å·¦ä¾§å­æ ‘å’Œå³ä¾§å­æ ‘éƒ½æ˜¯ BSTã€‚

äºŒå‰æœç´¢æ ‘å¹¶ä¸ç®—å¤æ‚ï¼Œä½†æˆ‘è§‰å¾—å®ƒå¯ä»¥ç®—æ˜¯æ•°æ®ç»“æ„é¢†åŸŸçš„åŠå£æ±Ÿå±±ï¼Œç›´æ¥åŸºäº BST çš„æ•°æ®ç»“æ„æœ‰ AVL æ ‘ï¼Œçº¢é»‘æ ‘ç­‰ç­‰ï¼Œæ‹¥æœ‰äº†è‡ªå¹³è¡¡æ€§è´¨ï¼Œå¯ä»¥æä¾› logN çº§åˆ«çš„å¢åˆ æŸ¥æ”¹æ•ˆç‡ï¼›è¿˜æœ‰ B+ æ ‘ï¼Œçº¿æ®µæ ‘ç­‰ç»“æ„éƒ½æ˜¯åŸºäº BST çš„æ€æƒ³æ¥è®¾è®¡çš„ã€‚

**ä»åšç®—æ³•é¢˜çš„è§’åº¦æ¥çœ‹ BSTï¼Œé™¤äº†å®ƒçš„å®šä¹‰ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ€§è´¨ï¼šBST çš„ä¸­åºéå†ç»“æœæ˜¯æœ‰åºçš„ï¼ˆå‡åºï¼‰**ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¾“å…¥ä¸€æ£µ BSTï¼Œä»¥ä¸‹ä»£ç å¯ä»¥å°† BST ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼å‡åºæ‰“å°å‡ºæ¥ï¼š
```python
def traverse(root):
    if not root:
        return
    traverse(root.left)
    # ä¸­åºéå†ä»£ç ä½ç½®
    print(root.val)
    traverse(root.right)
```

## å¯»æ‰¾ç¬¬ K å°çš„å…ƒç´ 
è¿™æ˜¯åŠ›æ‰£ç¬¬ 230 é¢˜ã€Œ [äºŒå‰æœç´¢æ ‘ä¸­ç¬¬ K å°çš„å…ƒç´ ](https://leetcode.cn/problems/kth-smallest-element-in-a-bst/) ã€ï¼Œçœ‹ä¸‹é¢˜ç›®ï¼š

ç»™å®šä¸€ä¸ªäºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹Â `root`Â ï¼Œå’Œä¸€ä¸ªæ•´æ•°Â `k`Â ï¼Œè¯·ä½ è®¾è®¡ä¸€ä¸ªç®—æ³•æŸ¥æ‰¾å…¶ä¸­ç¬¬Â `k`Â ä¸ªæœ€å°å…ƒç´ ï¼ˆä» 1 å¼€å§‹è®¡æ•°ï¼‰ã€‚

**ç¤ºä¾‹ 1ï¼š**
![[Pasted image 20240717001949.png]]

**è¾“å…¥ï¼š** root = \[3,1,4,null,2], k = 1
**è¾“å‡ºï¼š** 1

**ç¤ºä¾‹ 2ï¼š**
![[Pasted image 20240717002019.png]]
**è¾“å…¥ï¼š** root = \[5,3,6,2,4,null,null,1], k = 3
**è¾“å‡ºï¼š** 3

**æç¤ºï¼š**
- æ ‘ä¸­çš„èŠ‚ç‚¹æ•°ä¸ºÂ `n`Â ã€‚
- `1 <= k <= n <= 104`
- `0 <= Node.val <= 104`

**è¿›é˜¶ï¼š** å¦‚æœäºŒå‰æœç´¢æ ‘ç»å¸¸è¢«ä¿®æ”¹ï¼ˆæ’å…¥/åˆ é™¤æ“ä½œï¼‰å¹¶ä¸”ä½ éœ€è¦é¢‘ç¹åœ°æŸ¥æ‰¾ç¬¬Â `k`Â å°çš„å€¼ï¼Œä½ å°†å¦‚ä½•ä¼˜åŒ–ç®—æ³•ï¼Ÿ

è¿™ä¸ªéœ€æ±‚å¾ˆå¸¸è§å§ï¼Œä¸€ä¸ªç›´æ¥çš„æ€è·¯å°±æ˜¯å‡åºæ’åºï¼Œç„¶åæ‰¾ç¬¬Â `k`Â ä¸ªå…ƒç´ å‘—ã€‚BST çš„ä¸­åºéå†å…¶å®å°±æ˜¯å‡åºæ’åºçš„ç»“æœï¼Œæ‰¾ç¬¬Â `k`Â ä¸ªå…ƒç´ è‚¯å®šä¸æ˜¯ä»€ä¹ˆéš¾äº‹ã€‚

æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œå¯ä»¥ç›´æ¥å†™å‡ºä»£ç ï¼š
```python
class Solution:  
    def __init__(self):  
        self.res = 0  
        self.rank = 0  
  
    def kthSmallest(self, root: Optional[TreeNode], k: int) -> int:  
        self.traverse(root, k)  
        return self.res  
  
    def traverse(self, root: Optional[TreeNode], k: int):  
        if not root:  
            return  
  
        self.traverse(root.left, k)  
  
        self.rank += 1  
        if self.rank == k:  
            self.res = root.val  
            return  
  
        self.traverse(root.right, k)
```

## BST è½¬åŒ–ç´¯åŠ æ ‘
åŠ›æ‰£ç¬¬ 538 é¢˜å’Œ 1038 é¢˜éƒ½æ˜¯è¿™é“é¢˜ï¼Œå®Œå…¨ä¸€æ ·ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬ä¸€å—åšæ‰ã€‚çœ‹ä¸‹é¢˜ç›®ï¼š

ç»™å‡ºäºŒå‰Â **æœç´¢**Â æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¯¥æ ‘çš„èŠ‚ç‚¹å€¼å„ä¸ç›¸åŒï¼Œè¯·ä½ å°†å…¶è½¬æ¢ä¸ºç´¯åŠ æ ‘ï¼ˆGreater Sum Treeï¼‰ï¼Œä½¿æ¯ä¸ªèŠ‚ç‚¹Â `node`Â çš„æ–°å€¼ç­‰äºåŸæ ‘ä¸­å¤§äºæˆ–ç­‰äºÂ `node.val`Â çš„å€¼ä¹‹å’Œã€‚

æé†’ä¸€ä¸‹ï¼ŒäºŒå‰æœç´¢æ ‘æ»¡è¶³ä¸‹åˆ—çº¦æŸæ¡ä»¶ï¼š
- èŠ‚ç‚¹çš„å·¦å­æ ‘ä»…åŒ…å«é”®Â **å°äº**Â èŠ‚ç‚¹é”®çš„èŠ‚ç‚¹ã€‚
- èŠ‚ç‚¹çš„å³å­æ ‘ä»…åŒ…å«é”®Â **å¤§äº**Â èŠ‚ç‚¹é”®çš„èŠ‚ç‚¹ã€‚
- å·¦å³å­æ ‘ä¹Ÿå¿…é¡»æ˜¯äºŒå‰æœç´¢æ ‘ã€‚

**ç¤ºä¾‹ 1ï¼š**
![[Pasted image 20240717002914.png]]
**è¾“å…¥ï¼š**\[4,1,6,0,2,5,7,null,null,null,3,null,null,null,8]
**è¾“å‡ºï¼š**\[30,36,21,36,35,26,15,null,null,null,33,null,null,null,8]

**ç¤ºä¾‹ 2ï¼š**
**è¾“å…¥ï¼š** root = \[0,null,1]
**è¾“å‡ºï¼š**\[1,null,1]

**ç¤ºä¾‹ 3ï¼š**
**è¾“å…¥ï¼š** root = \[1,0,2]
**è¾“å‡ºï¼š**\[3,3,2]

**ç¤ºä¾‹ 4ï¼š**
**è¾“å…¥ï¼š** root = \[3,2,4,1]
**è¾“å‡ºï¼š**\[7,9,4,10]

**æç¤ºï¼š**
- æ ‘ä¸­çš„èŠ‚ç‚¹æ•°ä»‹äºÂ `0`Â å’ŒÂ `104`Â ä¹‹é—´ã€‚
- æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ä»‹äºÂ `-104`Â å’ŒÂ `104`Â ä¹‹é—´ã€‚
- æ ‘ä¸­çš„æ‰€æœ‰å€¼Â **äº’ä¸ç›¸åŒ**Â ã€‚
- ç»™å®šçš„æ ‘ä¸ºäºŒå‰æœç´¢æ ‘ã€‚

é¢˜ç›®åº”è¯¥ä¸éš¾ç†è§£ï¼Œæ¯”å¦‚å›¾ä¸­çš„èŠ‚ç‚¹ 5ï¼Œè½¬åŒ–æˆç´¯åŠ æ ‘çš„è¯ï¼Œæ¯” 5 å¤§çš„èŠ‚ç‚¹æœ‰ 6ï¼Œ7ï¼Œ8ï¼ŒåŠ ä¸Š 5 æœ¬èº«ï¼Œæ‰€ä»¥ç´¯åŠ æ ‘ä¸Šè¿™ä¸ªèŠ‚ç‚¹çš„å€¼åº”è¯¥æ˜¯ 5+6+7+8=26ã€‚

æŒ‰ç…§äºŒå‰æ ‘çš„é€šç”¨æ€è·¯ï¼Œéœ€è¦æ€è€ƒæ¯ä¸ªèŠ‚ç‚¹åº”è¯¥åšä»€ä¹ˆï¼Œä½†æ˜¯è¿™é“é¢˜ä¸Šå¾ˆéš¾æƒ³åˆ°ä»€ä¹ˆæ€è·¯ã€‚

BST çš„æ¯ä¸ªèŠ‚ç‚¹å·¦å°å³å¤§ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ—¢ç„¶ç´¯åŠ å’Œæ˜¯è®¡ç®—å¤§äºç­‰äºå½“å‰å€¼çš„æ‰€æœ‰å…ƒç´ ä¹‹å’Œï¼Œé‚£ä¹ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½å»è®¡ç®—å³å­æ ‘çš„å’Œï¼Œä¸å°±è¡Œäº†å—ï¼Ÿ

è¿™æ˜¯ä¸è¡Œçš„ã€‚å¯¹äºä¸€ä¸ªèŠ‚ç‚¹æ¥è¯´ï¼Œç¡®å®å³å­æ ‘éƒ½æ˜¯æ¯”å®ƒå¤§çš„å…ƒç´ ï¼Œä½†é—®é¢˜æ˜¯å®ƒçš„çˆ¶èŠ‚ç‚¹ä¹Ÿå¯èƒ½æ˜¯æ¯”å®ƒå¤§çš„å…ƒç´ å‘€ï¼Ÿè¿™ä¸ªæ²¡æ³•ç¡®å®šçš„ï¼Œæˆ‘ä»¬åˆæ²¡æœ‰è§¦è¾¾çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæ‰€ä»¥äºŒå‰æ ‘çš„é€šç”¨æ€è·¯åœ¨è¿™é‡Œç”¨ä¸äº†ã€‚

**å…¶å®ï¼Œæ­£ç¡®çš„è§£æ³•å¾ˆç®€å•ï¼Œè¿˜æ˜¯åˆ©ç”¨ BST çš„ä¸­åºéå†ç‰¹æ€§**ã€‚

åˆšæ‰æˆ‘ä»¬è¯´äº† BST çš„ä¸­åºéå†ä»£ç å¯ä»¥å‡åºæ‰“å°èŠ‚ç‚¹çš„å€¼ï¼Œé‚£å¦‚æœæˆ‘æƒ³é™åºæ‰“å°èŠ‚ç‚¹çš„å€¼æ€ä¹ˆåŠï¼Ÿå¾ˆç®€å•ï¼Œåªè¦æŠŠé€’å½’é¡ºåºæ”¹ä¸€ä¸‹å°±è¡Œäº†ï¼ˆå…ˆå³åå·¦ï¼‰ï¼š
```python
def traverse(root):
    if root is None:
        return
    traverse(root.right)
    # ä¸­åºéå†ä»£ç ä½ç½®
    print(root.val)
    traverse(root.left)
```
**è¿™æ®µä»£ç å¯ä»¥é™åºæ‰“å° BST èŠ‚ç‚¹çš„å€¼ï¼Œå¦‚æœç»´æŠ¤ä¸€ä¸ªå¤–éƒ¨ç´¯åŠ å˜é‡Â `sum`ï¼Œç„¶åæŠŠÂ `sum`Â èµ‹å€¼ç»™ BST ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸å°±å°† BST è½¬åŒ–æˆç´¯åŠ æ ‘äº†å—**ï¼Ÿä»£ç å¦‚ä¸‹ï¼š
```python
class Solution:  
    def __init__(self):  
        self.preSum = 0  
  
    def convertBST(self, root: Optional[TreeNode]) -> Optional[TreeNode]:  
        self.traverse(root)  
        return root  
  
    def traverse(self, root):  
        if not root:  
            return  
        self.traverse(root.right)  
        self.preSum += root.val  
        root.val = self.preSum  
        self.traverse(root.left)
```